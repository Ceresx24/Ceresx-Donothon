<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ceres Donothon Dashboard — GOD TIER</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@600&display=swap" rel="stylesheet">
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-database-compat.js"></script>
<style>
:root{--bg:#0d0b1c;--card:#14132b;--accent:#a855f7;--accent2:#c17aff;--text:#e2e8f0;--success:#00ffaa;--danger:#ff3366;--border:#2d2a57}
body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;display:flex;align-items:center;justify-content:center;}
#loginScreen{background:linear-gradient(135deg,#14132b,#0f0f22);width:420px;padding:50px 40px;border-radius:20px;text-align:center;border:1px solid var(--border)}
#loginScreen h1{font-size:36px;margin-bottom:10px;background:linear-gradient(90deg,#a855f7,#00e5ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
input,button{width:100%;padding:14px 16px;border-radius:12px;border:none;font-size:16px;margin:8px 0;background:#1e1c38;color:var(--text)}
button{background:var(--accent);color:white;font-weight:600;cursor:pointer;transition:.2s}
button:hover{background:#c17aff;transform:translateY(-2px)}
button.success{background:#00c853} button.danger{background:var(--danger)}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(360px,1fr));gap:24px}
.card{background:var(--card);border-radius:16px;padding:28px;border:1px solid var(--border);box-shadow:0 8px 32px rgba(0,0,0,.4)}
.card h2{font-size:24px;color:var(--accent);margin-bottom:20px}
.color-row{display:grid;grid-template-columns:1fr auto;gap:12px;align-items:center;margin:10px 0}
.slider-row{display:grid;grid-template-columns:1fr auto;gap:12px;align-items:center;margin:10px 0}
.milestone-card{border:1px solid var(--border);padding:12px;border-radius:12px;margin:8px 0;background:#1e1c38}
.live-preview{background:linear-gradient(135deg,#14132b,#0f0f22);padding:32px;border-radius:20px;text-align:center;border:1px solid var(--border);margin-bottom:30px}
#liveTimer{font-family:'JetBrains Mono',monospace;font-size:92px;background:linear-gradient(90deg,#00ffaa,#00e5ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
</style>
</head>
<body>

<div id="loginScreen">
  <h1>CERES DONOTHON</h1>
  <p>Control Panel</p>
  <input type="password" id="pw" placeholder="Password" autofocus>
  <button onclick="login()">UNLOCK</button>
</div>

<div id="main" style="display:none;max-width:1400px;width:100%;padding:20px">
  <h1 style="text-align:center;background:linear-gradient(90deg,#a855f7,#00e5ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:20px">
    Ceres Donothon — GOD TIER DASHBOARD
  </h1>

  <div class="live-preview">
    <h2 style="color:#fff">Donothon by <span id="liveName">Ceres</span></h2>
    <div id="liveTimer">03:00:00</div>
    <div style="font-size:28px">Raised: $<span id="liveRaised">0.00</span></div>
  </div>

  <div class="grid">
    <!-- Overlay Colors -->
    <div class="card">
      <h2>Overlay Colors</h2>
      <div class="color-row"><label>Timer Glow</label><input type="color" value="#00ffaa" onchange="saveTheme('th',this.value)"></div>
      <div class="color-row"><label>Bar Start</label><input type="color" value="#a855f7" onchange="saveTheme('g1',this.value)"></div>
      <div class="color-row"><label>Bar End</label><input type="color" value="#00e5ff" onchange="saveTheme('g2',this.value)"></div>
      <div class="color-row"><label>Background</label><input type="color" value="#0d0b1c" onchange="saveTheme('bg',this.value)"></div>
      <div class="color-row"><label>Text</label><input type="color" value="#e2e8f0" onchange="saveTheme('text',this.value)"></div>
    </div>

    <!-- Timer Control -->
    <div class="card">
      <h2>Timer Control</h2>
      <input type="number" id="startHours" value="3" min="0"><input type="number" id="startMinutes" value="0" min="0" max="59">
      <button class="success" onclick="startTimer()">START TIMER</button>
      <button id="pauseBtn" onclick="togglePause()">PAUSE TIMER</button>
      <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-top:10px">
        <button onclick="addTime(5)">+5 min</button>
        <button onclick="addTime(10)">+10 min</button>
        <button onclick="addTime(30)">+30 min</button>
      </div>
    </div>

    <!-- Milestone Management -->
    <div class="card">
      <h2>Milestones</h2>
      <div id="milestonesContainer">Loading...</div>
      <div style="display:flex;gap:8px;margin-top:10px">
        <input type="number" placeholder="$ Amount" id="newGoalAmount">
        <input type="text" placeholder="Description" id="newGoalDesc">
        <button class="success" onclick="addGoal()">+ ADD</button>
      </div>
    </div>
  </div>
</div>

<script>
const PATH='donothon-ultimate-2025-x7k9p2m4q8z3v6n1';
const PASSWORDS=['Rin125','125','Rinmod125'];
firebase.initializeApp({
  apiKey:"AIzaSyBFQFPo85fIpaHWl3Kr0PZ6WIm5B6WVusA",
  authDomain:"ceres-donothon-timer.firebaseapp.com",
  databaseURL:"https://ceres-donothon-timer-default-rtdb.firebaseio.com",
  projectId:"ceres-donothon-timer"
});
const ref=firebase.database().ref(PATH);

document.getElementById('pw').addEventListener('keypress',e=>{if(e.key==='Enter') login()});
function login(){
  if(PASSWORDS.includes(document.getElementById('pw').value.trim())){
    document.getElementById('loginScreen').style.display='none';
    document.getElementById('main').style.display='block';
    init();
  } else alert('Wrong password');
}

function init(){
  setInterval(updateLive,500);
  ref.on('value',snap=>{
    const d=snap.val()||{};
    document.getElementById('liveName').textContent=d.settings?.streamerName||'Ceres';
    document.getElementById('liveRaised').textContent=(d.totalEarned||0).toFixed(2);
    loadMilestones(d.config?.milestones||{});
  });
}

function updateLive(){
  ref.once('value').then(snap=>{
    const d=snap.val()||{};
    // Timer
    let left=0;
    if(d.endTime||d.pausedAt){
      const bonus=(d.bonusSeconds||0)*1000;
      const base=d.paused&&d.pausedAt?d.pausedAt:(d.endTime||0);
      left=Math.max(0,Math.floor((base+bonus-Date.now())/1000));
    }
    const h=('0'+Math.floor(left/3600)).slice(-2);
    const m=('0'+Math.floor(left%3600/60)).slice(-2);
    const s=('0'+left%60).slice(-2);
    document.getElementById('liveTimer').textContent=`${h}:${m}:${s}`;
  });
}

// Timer functions
function startTimer(){
  const h=+document.getElementById('startHours').value||0;
  const m=+document.getElementById('startMinutes').value||0;
  ref.update({endTime:Date.now()+(h*3600+m*60)*1000,bonusSeconds:0,paused:false,pausedAt:null});
}
function togglePause(){
  ref.once('value').then(snap=>{
    const d=snap.val()||{};
    const now=Date.now();
    if(d.paused){
      const frozen=d.pausedAt;
      ref.update({endTime:frozen,paused:false,pausedAt:null});
    } else{
      const frozen=d.endTime||(now+10800000);
      ref.update({paused:true,pausedAt:frozen,endTime:null});
    }
  });
}
function addTime(m){ ref.child('bonusSeconds').transaction(v=>(v||0)+m*60); }

// Milestones
function addGoal(){
  const amt=+document.getElementById('newGoalAmount').value;
  const desc=document.getElementById('newGoalDesc').value.trim();
  if(!amt||!desc)return alert('Fill both!');
  ref.child('config/milestones').push({amount:amt,description:desc});
  document.getElementById('newGoalAmount').value='';
  document.getElementById('newGoalDesc').value='';
}

function loadMilestones(milestones){
  const container=document.getElementById('milestonesContainer');
  container.innerHTML='';
  Object.entries(milestones).sort((a,b)=>a[1].amount-b[1].amount)
    .forEach(([id,m])=>{
      const card=document.createElement('div'); card.className='milestone-card';
      card.innerHTML=`$${m.amount.toFixed(2)} - ${m.description}`;
      container.appendChild(card);
    });
}

// Theme Colors
function saveTheme(k,v){ ref.child('theme/'+k).set(v); }

</script>
</body>
</html>
