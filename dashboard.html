<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ceres Donothon — Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.13.1/firebase-database-compat.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@600&display=swap" rel="stylesheet">
<style>
:root{--bg:#0d0b1c;--card:#14132b;--accent:#a855f7;--accent2:#c17aff;--text:#e2e8f0;--muted:#94a3b8;--success:#00ffaa;--danger:#ff3366;--border:#2d2a57}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;display:flex;align-items:center;justify-content:center;background-image:radial-gradient(circle at top right,#1a1650 0%,transparent 50%)}
#loginScreen{background:linear-gradient(135deg,#14132b,#0f0f22);width:420px;padding:50px 40px;border-radius:20px;box-shadow:0 20px 60px rgba(0,0,0,0.6);text-align:center;border:1px solid var(--border)}
#loginScreen h1{font-size:36px;margin-bottom:10px;background:linear-gradient(90deg,#a855f7,#00e5ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
#loginScreen input,#loginScreen button{width:100%;padding:16px;border-radius:14px;margin:10px 0;font-size:18px}
#loginScreen input{background:#1e1c38;border:none;color:white}
#loginScreen button{background:var(--accent);border:none;color:white;font-weight:600;cursor:pointer}
#main{display:none;max-width:1400px;width:100%;padding:30px}
header h1{font-size:44px;text-align:center;background:linear-gradient(90deg,#a855f7,#00e5ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(360px,1fr));gap:24px}
.card{background:var(--card);border-radius:16px;padding:28px;border:1px solid var(--border);box-shadow:0 8px 32px rgba(0,0,0,0.4)}
.card h2{font-size:24px;color:var(--accent);margin-bottom:20px;display:flex;align-items:center;gap:10px}
.card h2::before{content:"▹"}
input,button{width:100%;padding:14px 16px;border-radius:12px;border:none;font-size:16px;margin:8px 0;background:#1e1c38;color:var(--text)}
button{background:var(--accent);color:white;font-weight:600;cursor:pointer;transition:.2s}
button:hover{background:var(--accent2);transform:translateY(-2px)}
button.success{background:#00c853} button.danger{background:var(--danger)}
footer{text-align:center;margin-top:50px;color:var(--muted);font-size:14px}
</style>
</head>
<body>

<div id="loginScreen">
  <h1>CERES DONOTHON</h1>
  <p>Control Panel Access</p>
  <input type="password" id="pw" placeholder="Enter password">
  <button onclick="login()">UNLOCK DASHBOARD</button>
</div>

<div id="main">
  <header><h1>Ceres Donothon Control Panel</h1></header>
  <div class="grid">
    <div class="card">
      <h2>Timer Control</h2>
      <button class="success" onclick="startTimer()">START 3-HOUR TIMER</button>
      <button id="pauseBtn" onclick="togglePause()">PAUSE</button>
      <button class="danger" onclick="resetAll()">RESET ALL DATA</button>
    </div>

    <div class="card">
      <h2>Manual Add</h2>
      <input type="number" step="0.01" id="addMoney" placeholder="Donation amount ($)">
      <input type="number" id="addMinutes" placeholder="Extra minutes">
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:10px">
        <button onclick="addMoneyAndTime()">Add $ + Time</button>
        <button onclick="addMoneyOnly()">Add $ Only (+1min/$)</button>
      </div>
      <button style="margin-top:10px" onclick="addTimeOnly()">Add Time Only</button>
    </div>

    <div class="card">
      <h2>Overlay Customization</h2>
      <label>Total Goal ($)</label>
      <input type="number" id="dashboardGoal" value="10000">
      <button onclick="updateGoal()">Save Goal</button>

      <label>Accent Color</label><input type="color" id="accentColor">
      <label>Gradient Start</label><input type="color" id="grad1Color">
      <label>Gradient End</label><input type="color" id="grad2Color">
      <label>Goal Hit Color</label><input type="color" id="goalHitColor">
      <label>Timer Hit Color</label><input type="color" id="timerHitColor">
      <button onclick="saveThemeColors()">Save Colors</button>

      <label><input type="checkbox" id="hideSubs"> Hide Subs/Bits Line</label>
      <label><input type="checkbox" id="hideGoal"> Hide Goal Text</label>
      <label><input type="checkbox" id="hideFooter"> Hide Footer</label>
      <label><input type="checkbox" id="confetti"> Enable Confetti</label>

      <label>Overlay Scale</label>
      <input type="range" min="50" max="200" value="100" id="overlayScale" oninput="document.getElementById('scaleVal').textContent=this.value">
      <span id="scaleVal">100</span>%
      <button onclick="saveOverlayScale()">Apply Scale</button>

      <label>Celebration Sound URL</label>
      <input type="text" id="soundUrl">
      <label>Sound Volume</label>
      <input type="range" min="0" max="100" value="100" id="soundVolume">
      <button onclick="saveSound()">Save Sound</button>
    </div>
  </div>
  <footer>Ceres Donothon Timer • 2025</footer>
</div>

<script>
const PATH = 'donothon-ultimate-2025-x7k9p2m4q8z3v6n1';
const PASSWORDS = ['Rin125','125','Rinmod125'];
firebase.initializeApp({apiKey:"AIzaSyBFQFPo85fIpaHWl3Kr0PZ6WIm5B6WVusA",authDomain:"ceres-donothon-timer.firebaseapp.com",databaseURL:"https://ceres-donothon-timer-default-rtdb.firebaseio.com",projectId:"ceres-donothon-timer"});
const db = firebase.database().ref(PATH);

// Login
document.getElementById('pw').addEventListener('keypress', e => e.key==='Enter' && login());
function login() {
  if(PASSWORDS.includes(document.getElementById('pw').value.trim())){
    document.getElementById('loginScreen').style.display='none';
    document.getElementById('main').style.display='block';
  } else alert('Wrong password');
}

// Timer controls
function togglePause(){db.once('value').then(snap=>{const d=snap.val()||{}; if(d.paused){const bonus=(d.bonusSeconds||0)*1000; const remaining=d.pausedAt+bonus-Date.now(); db.update({endTime:Date.now()+Math.max(0,remaining),paused:false,pausedAt:null});} else {const bonus=(d.bonusSeconds||0)*1000; const frozenAt=Date.now()+((d.endTime||0)+bonus-Date.now()); db.update({paused:true,pausedAt:frozenAt,endTime:null});}});}
function startTimer(){db.update({endTime:Date.now()+10800000,bonusSeconds:0,paused:false,pausedAt:null});}
function addMoneyAndTime(){const m=+document.getElementById('addMoney').value||0; const t=+document.getElementById('addMinutes').value||0;if(m||t) db.transaction(x=>{x.totalEarned=(x.totalEarned||0)+m;x.bonusSeconds=(x.bonusSeconds||0)+t*60;return x;}); document.getElementById('addMoney').value=''; document.getElementById('addMinutes').value='';}
function addMoneyOnly(){const m=+document.getElementById('addMoney').value||0;if(m) db.transaction(x=>{x.totalEarned=(x.totalEarned||0)+m;x.bonusSeconds=(x.bonusSeconds||0)+m*60;return x;}); document.getElementById('addMoney').value='';}
function addTimeOnly(){const t=+document.getElementById('addMinutes').value||0;if(t) db.child('bonusSeconds').transaction(v=>(v||0)+t*60); document.getElementById('addMinutes').value='';}
function resetAll(){if(confirm('This deletes EVERYTHING. Are you sure?')) db.set({config:{milestones:{},goal:10000},settings:{},theme:{},totalEarned:0,bonusSeconds:0,endTime:null,paused:false,pausedAt:null,subsCount:0,bitsCount:0});}

// Overlay customizations
function updateGoal(){const val=+document.getElementById('dashboardGoal').value;if(val>0) db.child('config/goal').set(val);}
function saveThemeColors(){db.child('theme').update({accent:document.getElementById('accentColor').value,grad1:document.getElementById('grad1Color').value,grad2:document.getElementById('grad2Color').value,goalHitColor:document.getElementById('goalHitColor').value,timerHitColor:document.getElementById('timerHitColor').value});}
function saveOverlayScale(){db.child('theme/goalScale').set(document.getElementById('overlayScale').value/100);}
function saveSound(){db.child('theme').update({sound:document.getElementById('soundUrl').value||null,soundVolume:document.getElementById('soundVolume').value});}
['hideSubs','hideGoal','hideFooter','confetti'].forEach(id=>document.getElementById(id).addEventListener('change', e=>db.child('theme').child(id).set(e.target.checked)));
</script>
</body>
</html>
